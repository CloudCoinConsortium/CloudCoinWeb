<html>
<head>

    <script src="random.min.js"></script>
    <script src="CloudCoin.js"></script>
    
    <script src="FileUtils.js"></script>
    <!-- <script src="FileSaver.js"></script> -->
    <script src="DetectionAgent.js"></script>
    <script src="RAIDA_Status.js"></script>
    <script src="RaidaResponse.js"></script>
    <!--
    <script type="text/javascript">
    //prefixes of implementation that we want to test
         window.indexedDB = window.indexedDB || window.mozIndexedDB || window.webkitIndexedDB || window.msIndexedDB;
         
         //prefixes of window.IDB objects
         window.IDBTransaction = window.IDBTransaction || window.webkitIDBTransaction || window.msIDBTransaction;
         window.IDBKeyRange = window.IDBKeyRange || window.webkitIDBKeyRange || window.msIDBKeyRange
         
         if (!window.indexedDB) {
            window.alert("Your browser doesn't support a stable version of IndexedDB.")
         }

         var db;
        var request = indexedDB.open("localcloudcoins");
        request.onerror = function(event) {
            console.log("error: ");
         };
         
         request.onsuccess = function(event) {
            db = request.result;
            console.log("success: "+ db);
            
         };
         request.onupgradeneeded = function(event) {
            console.log("upgrading");
            var db = event.target.result;
            var objectStore = db.createObjectStore("cloudcoin", {keyPath: "filename"});
            
            
            }
         
        
         </script>
-->
</head>
<body>
<h1>Test FileUtils.js</h1>

<div id="output"></div>
<h2>Display Test Coin()</h2>
<button onclick="displayTestCoin()">Display</button>
<script>
function displayTestCoin() {
document.getElementById("output").innerHTML = testCoin.nn + " " + testCoin.sn;
}
    </script>

<script>
    localStorage.removeItem("cctestjson");
    localStorage.removeItem("seancoin");
    localStorage.removeItem("cctest0json");
var testCoin;
let testaoid = ["owner=470603102f95f581689cf0fe13951cce", "account=yes"];
    let testans = ["470603102f95f581689cf0fe13951cce", "470603102f95f581689cf0fe13951cce","470603102f95f581689cf0fe13951cce","470603102f95f581689cf0fe13951cce","470603102f95f581689cf0fe13951cce","470603102f95f581689cf0fe13951cce","470603102f95f581689cf0fe13951cce","470603102f95f581689cf0fe13951cce","470603102f95f581689cf0fe13951cce","470603102f95f581689cf0fe13951cce","470603102f95f581689cf0fe13951cce","470603102f95f581689cf0fe13951cce","470603102f95f581689cf0fe13951cce","470603102f95f581689cf0fe13951cce","470603102f95f581689cf0fe13951cce","470603102f95f581689cf0fe13951cce","470603102f95f581689cf0fe13951cce","470603102f95f581689cf0fe13951cce","470603102f95f581689cf0fe13951cce","470603102f95f581689cf0fe13951cce","470603102f95f581689cf0fe13951cce","470603102f95f581689cf0fe13951cce","470603102f95f581689cf0fe13951cce","470603102f95f581689cf0fe13951cce","470603102f95f581689cf0fe13951cce"];
   testCoin = new CloudCoin(1, 16777216, testans, "2012-03-19:07:22", testaoid );
   


    </script>

<h2>Save Coin</h2>
<button onclick="saveCoin()">Save</button>
<script>
function saveCoin() {
    var fileU = new FileUtils();
    fileU.saveCloudCoinToJsonFile(testCoin, testCoin.sn);
}
    </script>

    <h2>Alert Saved Coin</h2>
<button onclick="alertSaved()">Test</button>
<script>
function alertSaved() {
    alert(localStorage.getItem("seancoin"));
}
    </script>

<h2>Save Custom Coin</h2>
<button onclick="saveNewCoin()">Save</button>
<script>
function saveNewCoin() {
    var fileU = new FileUtils();
    let newCoin = new CloudCoin();
    let rawString = "1,16777215,470603102f95f581689cf0fe13951cce,470603102f95f581689cf0fe13951cce,470603102f95f581689cf0fe13951cce,470603102f95f581689cf0fe13951cce,470603102f95f581689cf0fe13951cce,470603102f95f581689cf0fe13951cce,470603102f95f581689cf0fe13951cce,470603102f95f581689cf0fe13951cce,470603102f95f581689cf0fe13951cce,470603102f95f581689cf0fe13951cce,470603102f95f581689cf0fe13951cce,470603102f95f581689cf0fe13951cce,470603102f95f581689cf0fe13951cce,470603102f95f581689cf0fe13951cce,470603102f95f581689cf0fe13951cce,470603102f95f581689cf0fe13951cce,470603102f95f581689cf0fe13951cce,470603102f95f581689cf0fe13951cce,470603102f95f581689cf0fe13951cce,470603102f95f581689cf0fe13951cce,470603102f95f581689cf0fe13951cce,470603102f95f581689cf0fe13951cce,470603102f95f581689cf0fe13951cce,470603102f95f581689cf0fe13951cce,470603102f95f581689cf0fe13951cce";
    let arrayString = rawString.split(",");
    let nn = arrayString[0];
    let sn = arrayString[1];
    let ans = [ arrayString[2], arrayString[3], arrayString[4], arrayString[5], arrayString[6], arrayString[7], arrayString[8], arrayString[9], arrayString[10], arrayString[11], arrayString[12], arrayString[13], arrayString[14], arrayString[15], arrayString[16], arrayString[17], arrayString[18], arrayString[19], arrayString[20], arrayString[21], arrayString[22], arrayString[23], arrayString[24], arrayString[25], arrayString[26]  ];
    //Make coin from string parts
    let myCoin = new CloudCoin(nn, sn, ans, 4, "", "uuuuuuuuuuuuuuuuuuuuuuuuu" );
    fileU.saveCloudCoinToJsonFile(newCoin, "0");
    fileU.saveCloudCoinToJsonFile(myCoin, myCoin.sn);
}
    </script>

<h2>Load Custom Test Coin</h2>
<button onclick="loadCoin()">Load</button>
<script>
function loadCoin() {
    var fileU = new FileUtils();
    testCoin = fileU.loadOneCloudCoinFromJsonFile("cctest0json");
    
    
}
    </script>
<!--
<h2>delete</h2>
<button onclick="deletedb()">Load</button>
<script>
function deletedb() {
    var request = indexedDB.deleteDatabase("localcloudcoins");
}
    </script>
<h2>read</h2>
<button onclick="readdb()">Load</button>
<script>
function readdb() {
    let transaction = db.transaction(["cloudcoin"]);
        let objectStore = transaction.objectStore("cloudcoin");
        let request = objectStore.get("cctest0json");
        request.onsuccess = function(event) {
      if(request.result) {
        alert(request.result.nn) ;
         alert(request.result.sn);
        alert(request.result.an);
        alert(request.result.ed);
        alert(request.result.aoid);
        alert(request.result.pown);
}}}
    </script>
<h2>Detect Test Coin</h2>
<button onclick="detectCoin()">Load</button>
<script>
function detectCoin() {
    var fileU = new FileUtils();
    let rr = fileU.detectOneCloudCoinFromJsonFile("cctestjson");
    alert(rr.outcome);
    
    
}
    </script>
    -->
</body>
</html>